(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14299,        361]
NotebookOptionsPosition[     13777,        343]
NotebookOutlinePosition[     14213,        360]
CellTagsIndexPosition[     14170,        357]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"simulateObjectMotion2D", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "=", "0"}], ",", 
        RowBox[{"trajectory", "=", 
         RowBox[{"{", "}"}]}], ",", "nHat", ",", "Fg", ",", "Fgn", ",", "Fgp",
         ",", "FgpL", ",", "FfU", ",", "Fn", ",", "FnL", ",", "FfHat", ",", 
        "FfK", ",", "FfV", ",", "aV", ",", "frictionType", ",", "p", ",", "v",
         ",", "g", ",", "n", ",", "mass", ",", "uStatic", ",", "uKinetic", 
        ",", "tA"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"Initial", " ", "conditions"}], "*)"}], 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Initial", " ", "position", " ", 
         RowBox[{"(", 
          RowBox[{"2", "D"}], ")"}]}], "*)"}], 
       RowBox[{"v", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Initial", " ", "velocity", " ", 
         RowBox[{"(", 
          RowBox[{"2", "D"}], ")"}]}], "*)"}], 
       RowBox[{"g", "=", "9.81"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Gravitational", " ", "acceleration"}], "*)"}], 
       RowBox[{"n", "=", 
        RowBox[{"{", 
         RowBox[{"6", ",", "10"}], "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Hill", " ", "normal", " ", "vector", " ", 
         RowBox[{"(", 
          RowBox[{"2", "D"}], ")"}]}], "*)"}], 
       RowBox[{"mass", "=", "1.1"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Mass", " ", "of", " ", "the", " ", "object"}], "*)"}], 
       RowBox[{"uStatic", "=", "0.5"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Static", " ", "friction", " ", "coefficient"}], "*)"}], 
       RowBox[{"uKinetic", "=", "0.4"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Kinetic", " ", "friction", " ", "coefficient"}], "*)"}], 
       RowBox[{"tA", "=", "0.01"}], ";", 
       RowBox[{"(*", 
        RowBox[{"Time", " ", "step"}], "*)"}], 
       RowBox[{"nHat", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Norm", "[", "n", "]"}]}], ")"}], " ", "n"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Unit", " ", "vector", " ", "of", " ", "the", " ", "hill", " ", 
         "normal"}], "*)"}], 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Continue", " ", "simulation", " ", "until", " ", "y", " ", 
           RowBox[{"(", "height", ")"}], " ", "is", " ", "0", " ", "or", " ", 
           "below"}], "*)"}], 
         RowBox[{"(*", 
          RowBox[{
          "Force", " ", "of", " ", "Gravity", " ", "in", " ", "the", " ", "2",
            "D", " ", "system"}], "*)"}], 
         RowBox[{
          RowBox[{"Fg", "=", 
           RowBox[{
            RowBox[{"-", "mass"}], " ", "g", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"Gravity", " ", "acts", " ", "vertically", " ", "down"}], 
           "*)"}], 
          RowBox[{"(*", 
           RowBox[{
           "Force", " ", "due", " ", "to", " ", "Gravity", " ", "Normal", " ",
             "to", " ", "Surface"}], "*)"}], 
          RowBox[{"Fgn", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Fg", ".", "nHat"}], ")"}], " ", "nHat"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Force", " ", "due", " ", "to", " ", "Gravity", " ", "Parallel", 
            " ", "to", " ", "Surface"}], "*)"}], 
          RowBox[{"Fgp", "=", 
           RowBox[{"Fg", "-", "Fgn"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FgpL", "=", 
           RowBox[{"Norm", "[", "Fgp", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Normal", " ", "Force"}], "*)"}], 
          RowBox[{"Fn", "=", 
           RowBox[{"-", "Fgn"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FnL", "=", 
           RowBox[{"Norm", "[", "Fn", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Determine", " ", "Friction", " ", "Type"}], "*)"}], 
          RowBox[{"FfU", "=", 
           RowBox[{"uStatic", " ", "FnL"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"Maximum", " ", "static", " ", "friction"}], "*)"}], 
          RowBox[{"frictionType", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FfU", "<=", "FgpL"}], ",", "\"\<Kinetic\>\"", ",", 
             "\"\<Static\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Frictional", " ", "Forces"}], "*)"}], 
          RowBox[{"FfHat", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FgpL", "!=", "0"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"1", "/", "FgpL"}], ")"}]}], " ", "Fgp"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"Direction", " ", "of", " ", "friction"}], "*)"}], 
          RowBox[{"FfK", "=", 
           RowBox[{"uKinetic", " ", "FnL"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"Kinetic", " ", "friction", " ", "magnitude"}], "*)"}], 
          RowBox[{"FfV", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"frictionType", "==", "\"\<Kinetic\>\""}], ",", 
             RowBox[{"FfK", " ", "FfHat"}], ",", 
             RowBox[{"-", "Fgp"}]}], "]"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"Friction", " ", "force"}], "*)"}], 
          RowBox[{"(*", 
           RowBox[{"Net", " ", "Force"}], "*)"}], 
          RowBox[{"Fnet", "=", 
           RowBox[{"Fgp", "+", "FfV"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", "Acceleration", "*)"}], 
          RowBox[{"aV", "=", 
           RowBox[{"Fnet", "/", "mass"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Update", " ", "Velocity", " ", "and", " ", "Position"}], 
           "*)"}], 
          RowBox[{"v", "=", 
           RowBox[{"v", "+", 
            RowBox[{"aV", " ", "tA"}]}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"New", " ", "velocity"}], "*)"}], 
          RowBox[{"p", "=", 
           RowBox[{"p", "+", 
            RowBox[{"v", " ", "tA"}]}]}], ";", 
          RowBox[{"(*", 
           RowBox[{"New", " ", "position"}], "*)"}], 
          RowBox[{"(*", 
           RowBox[{"Increment", " ", "time"}], "*)"}], 
          RowBox[{"t", "+=", "tA"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Store", " ", "position", " ", "for", " ", "plotting"}], 
           "*)"}], 
          RowBox[{"AppendTo", "[", 
           RowBox[{"trajectory", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "p"}], "}"}]}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "trajectory"}]}], " ", 
     RowBox[{"(*", 
      RowBox[{"Return", " ", "trajectory", " ", "data"}], "*)"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Run", " ", "the", " ", "2", "D", " ", "simulation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trajectoryData2D", "=", 
    RowBox[{"simulateObjectMotion2D", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Visualization", " ", "using", " ", "Manipulate"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"currentData", ",", "currentPoint"}], "}"}], ",", 
     RowBox[{
      RowBox[{"currentData", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"trajectoryData2D", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<=", "t"}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentPoint", "=", 
       RowBox[{
        RowBox[{"SelectFirst", "[", 
         RowBox[{"trajectoryData2D", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">=", "t"}], "&"}]}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
          RowBox[{"Point", "[", "currentData", "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Point", "[", "currentPoint", "]"}], ",", "Red", ",", 
            RowBox[{"PointSize", "[", "Large", "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "->", "True"}], ",", 
        RowBox[{"AxesOrigin", "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "->", "1"}], ",", 
        RowBox[{"PlotLabel", "->", "\"\<Trajectory of the Object\>\""}]}], 
       "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "0.1", ",", "\"\<Time\>\""}], "}"}], ",", 
     RowBox[{"trajectoryData2D", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"trajectoryData2D", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", "0.01"}], "}"}]}], 
  "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.942390180836553*^9, 3.9423901808375015`*^9}},
 CellLabel->
  "In[660]:=",ExpressionUUID->"b5fd327f-678c-40a5-a336-f3e3f15c35d4"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 2.149999999999998, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`t$$], 0.1, "Time"}, 0.01, 2.149999999999998, 0.01}}, 
    Typeset`size$$ = {251.99999999999997`, {131., 133.4875978584634}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0.1}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`currentData$, $CellContext`currentPoint$}, \
$CellContext`currentData$ = Part[
           
           Select[$CellContext`trajectoryData2D, 
            Part[#, 1] <= $CellContext`t$$& ], All, 
           2]; $CellContext`currentPoint$ = Part[
           
           SelectFirst[$CellContext`trajectoryData2D, 
            Part[#, 1] >= $CellContext`t$$& ], 2]; Graphics[{
           PointSize[Medium], 
           Point[$CellContext`currentData$], 
           Style[
            Point[$CellContext`currentPoint$], Red, 
            PointSize[Large]]}, Axes -> True, AxesOrigin -> {0, 0}, 
          PlotRange -> {{-2, 5}, {-2, 5}}, AspectRatio -> 1, PlotLabel -> 
          "Trajectory of the Object"]], 
      "Specifications" :> {{{$CellContext`t$$, 0.1, "Time"}, 0.01, 
         2.149999999999998, 0.01}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{289., {163.9938232632121, 168.0061767367879}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.9423782104536457`*^9, 3.942378366010538*^9, {3.9423784842134027`*^9, 
   3.9423785829784155`*^9}, 3.9423790088679323`*^9, 3.94237932364366*^9, 
   3.9423793795235777`*^9, {3.94238071513395*^9, 3.9423807308322597`*^9}, 
   3.942380808774825*^9, {3.942388695627264*^9, 3.9423886997065125`*^9}, {
   3.9423892385878897`*^9, 3.942389243375963*^9}, 3.9423893335177665`*^9, {
   3.9423895395172014`*^9, 3.9423895463815713`*^9}, 3.942389659499552*^9, 
   3.942389817366788*^9, 3.9423899669712424`*^9, 3.9423903720353756`*^9, 
   3.94239050590269*^9},
 CellLabel->
  "Out[662]=",ExpressionUUID->"3cd00c3c-c2a3-48cb-aa80-a08fc0f45d62"]
}, Open  ]]
},
WindowSize->{718.5, 735.},
WindowMargins->{{-5.25, Automatic}, {Automatic, 0}},
Magnification:>0.7 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7d2908f7-cb3e-4abd-852e-8b82cf60ba3b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 10241, 259, 553, "Input",ExpressionUUID->"b5fd327f-678c-40a5-a336-f3e3f15c35d4"],
Cell[10824, 283, 2937, 57, 345, "Output",ExpressionUUID->"3cd00c3c-c2a3-48cb-aa80-a08fc0f45d62"]
}, Open  ]]
}
]
*)

